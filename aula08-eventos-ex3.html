<!doctype html>
<html>
<head>
	<title>Curso Javascript Completo 2018</title>
	<meta charset="utf-8">
	
	<link href="css/bootstrap.css" rel="stylesheet">
	<link href="css/bootstrap-theme.css" rel="stylesheet">
	
	<script src="js/beluga.js"></script>

</head>
<body>
	
	<div class="container">
		<h1>Eventos Exemplo 3</h1>
		<textarea id="msg" cols="50" rows="10" maxlength="10">
			
		</textarea>
		<div id="restaContainer" style="display: none;">
			Restam <span id="resta">XX</span> caracteres
		</div>
		<button id="clear">Limpar</button>
	</div>
	
	<script>
		(function(){
			'user strict';
			var txtMsg = document.getElementById('msg');
			var maxima = txtMsg.maxLength;
			//quantidade maxima de caracteres permitidos
			var resta = document.getElementById('resta');
			var restaContainer = document.getElementById('restaContainer');

			var btnClear = document.getElementById('clear');

			txtMsg.addEventListener('input', checkLength);

			btnClear.addEventListener('click', clear);

			mostrarCaracteresRestantes(maxima);
			mostrarContainerResta();
			

			function checkLength(e){
				//recupero os caracteres digitados
				var numeroLetrasDigitadas = this.value.length;
				var caracteresRestantes = parseInt(maxima) - parseInt(numeroLetrasDigitadas);
				mostrarCaracteresRestantes(caracteresRestantes);
				desabilitaTextArea(numeroLetrasDigitadas, maxima);
			}

			function desabilitaTextArea(numeroLetrasDigitadas, maxima){
				if (numeroLetrasDigitadas === maxima){
					txtMsg.disabled = true;
				}
			}

			function mostrarCaracteresRestantes(n){
				resta.textContent = n;
			}

			function mostrarContainerResta(){
				restaContainer.style.display = 'block';
			}

			function clear(){
				txtMsg.value = '';
				txtMsg.disabled = false;
				mostrarCaracteresRestantes(maxima);
			}

		})();
	</script>
	
</body>
</html>